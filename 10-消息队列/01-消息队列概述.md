## 一 消息队列的引入

下面以传统的串行方式描述用户注册的流程：将用户的注册信息写入数据库成功后，依次进行发送注册成功邮件，发送注册成功短信。  

如图所示：  

![](../images/mq/mq-00-1.png)  

引入消息队列后，可以大大缩减响应的时间：将注册信息写入数据库成功后，发送注册邮件的同时，发送注册短信。  

![](../images/mq/mq-00-2.png)   

当然，这只是简单的一个消息队列在应用中的利用。大型成熟的消息系统可以在此基础上，进行业务解耦、异步处理等操作，对业务架构的影响是更加直观的。  

## 二 消息系统的分类

消息系统主要分为两种类型：
- 点对点：采用队列方式，如A->B，当B消费的队列中的数据，那么队列的数据就会被删除掉。
- 发布订阅：大多数的消息系统是基于发布-订阅消息系统

发布订阅类型消息的基础模型：  

![](../images/mq/mq-00-3.svg)  

发布订阅类型的消息系统主要有三大组件：
- 主题：消息的分类
- 发布者：将消息发送给消息系统（一般是主动推送）
- 订阅者：从消息系统中获取数据（可以采用拉/推方式）

## 三 消息系统的应用场景

消息中间件主要用于：
- 应用解耦：将一个大型的任务系统分成若干个小模块，模块之间通过不同的消息进行通信，由消息系统进行这些消息的统一管理
- 异步处理：如用户注册成功后，异步发送邮件通知用户
- 流量削峰：高峰流量进入消息队列处理，减轻后端压力
- 日志处理：如使用Kafka在大数据场景中进行日志收集

消息队列一般都内置了高效的通信机制，因此也可以用在纯的消息通讯，比如点对点的消息队列，或者聊天室等。  


