## 一 理解云原生

云原生的诞生，很大程度上源自于企业在团队规模快速扩张后，沟通效率低下，继而引发的类似交付速度变慢等一系列问题。云原生可以通过一系列工具、方法减少发布导致的可用性问题（但并不是减少发布次数！）。  

同样，当微服务架构中服务的数量大幅增加后，性能、一致性问题越来越严重，架构极其复杂，这些问题也导致了企业迫切需要更加流程化的解决方案。  

> 云原生（Cloud Native）是一系列**系统架构**、**研发流程**、**团队文化**最佳实践的集合，用来支撑企业提升研发效率、提供可靠服务。  

从系统架构来说：云原生以云、微服务为技术基础。这里的云可以是公有云、也可以是私有云，但是必须包含了敏捷基础设施、公共基础服务。  

从研发流程来说：云原生必须具备自动化的研发环境，以支持快速交付。所以应该保证各个环境的一致，容器技术基本成为事实的要求。  

从团队文化来说：微服务架构需要小团队具有自主决策权力，可以减少会议决策，团队成员需要具备自我驱动。  

## 二 云原生能力的衡量

我们可以通过成熟度模型来描述云原生的能力。  

第一阶段：
- 描述：实现粒度较大的业务拆分；部署在虚拟化环境中；应用通过镜像、脚本实现了自动化部署
- 技术：负载均衡、模块化、虚拟化隔离
- 效果：瀑布式开发；重构成本极高；可用性依赖运维

第二阶段：
- 描述：微服务架构，满足自治、隔离，且依据业务划分了等级，非核心业务能够实现快速降级；服务失败影响小，快速隔离
- 技术：微服务相关框架（Spring Cloud、Go micro）；持续交付的流水线；调用链分析；自动化测试；监控系统
- 效果：小团队开发，沟通成本低，对测试依赖降低

第三阶段：
- 描述：基础设施自建；能够提供大量的服务端中间件；业务无中断，灰度发布实现1%-10%-100%流程；自动伸缩；自动化降级；统一的开发、测试、生产环境；异地多活
- 技术：分布式数据库、分布式存储、分布式缓存、分布式消息队列、灰度发布平台、全局容错方案、全局一致性方案、资源调度平台
- 效果：无需择时发布，开发更专注于业务，架构则由基础设施提供

第四阶段：  
- 描述：系统具备自我学习、诊断、恢复能力等等
- 技术：AI、SeverLess
- 效果：高度可用，高度扩展能力，AIOps

## 三 云原生原则

必须为研发团队设定一定的原则来约束开发者：
- 为失败设计原则：服务数量急剧膨胀后，出现问题的概率也就越来越大，问题定位也会变得越来越困难。设计服务的时候必须充分考虑异常情况！
- 不变性原则：减少对部署的人工干预，提倡自动部署，自愈
- 简化设计原则：尽量以实现需求为目标，而不是盲目复杂化系统
- 演进设计原则：架构要保持持续演进，而不是一蹴而就
