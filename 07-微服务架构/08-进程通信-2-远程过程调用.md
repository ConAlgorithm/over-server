## 一 远程过程调用(RPI)原理 

客户端中的业务逻辑调用代理接口（由远程过程调用代理适配器来实现），该适配器通过接口调用服务的业务逻辑，并将回复发送回远程调用代理，最终代理将结果返回给客户端。  

常见的实现方式有：
- REST
- rpc

## 二 REST

REST强调资源，通常表示单个业务对象，如客户、产品、业务对象等，使用HTTP才操作，资源以XML或者JSON等格式返回。  

REST优点：
- 简单好用，测试方便
- 直接支持请求/响应方式的通信
- http对防火墙友好
- 不需要中间代理，简化了系统架构

REST弊端：
- 只支持请求/响应方式
- 客户端必须知道服务实例的位置，引起了架构中服务发现机制
- 严格遵守REST标准定义API很困难

## 三 RPC

常见的rpc框架是grpc。  

优点：
- 复杂API设计起来简单
- 通信更高效
- 支持在远程过程调用和消息传递过程中使用双向流式消息方式
- 实现了客户端和各种语言编写的服务端之间的互操作性

弊端：
- JavaScript操作rpc的API需要额外处理很多
- 旧式防火墙不支持http/2

## 四 局部故障问题

rpc与rest都是同步通信机制，会引起局部故障问题：  

```
分布式系统中，服务试图向另一个服务发送同步请求时，由于客户端和服务端是互相独立的进程，服务端可能无法再有限时间内对客户端请求作出响应，更可能因为故障而响应缓慢、暂停服务。  

此时客户端等待响应被阻塞，相应的其他客户端、第三方应用之间的传导都会造成影响，最终导致服务中断。
```

断路器：即远程过程调用的代理，在连续失败次数超过指定阈值后的一段时间内，这个代理会立即拒绝其他服务。  

常见代表软件有：Hystrix



## 三 rpc