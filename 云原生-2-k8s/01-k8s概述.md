## 一 k8s简介

Kubernetes是Google在2014年发布的一个开源项目，简称k8s，即k与s之间有8个字母。k8s可以整合多个正在运行的容器集群，用于对容器化应用程序进行自动部署、扩展、管理。  

k8s特性：
- 自动包装：根据资源需求、约束自动放置容器，同时不会牺牲可用性
- 横向缩放：可以依据用户命令、CPU负载情况调整应用程序副本数
- 自动部署和回滚：k8s会监控所有实例，若出现问题，则k8s会为用户恢复
- 存储鞭片：自动安装用户所选择的存储系统，无论是本地存储还是公有云提供的存储系统
- 自我修复：k8s会重新启动失效的容器
- 服务发现和负载均衡：k8s为容器提供了自己的IP地址和一组容器的单个DNS名称，实现了负载均衡

K8s是一个无侵入性的开放平台，现有系统能够很容易的迁移到k8s上，为企业提供了一个晚辈的分布式系统支撑平台。k8s提供的容器化架构，可以满足很多生产环境常见的需求：
- 多进程协同工作
- 存储系统挂载
- Distributing secrets
- 应用健康监测
- 应用实例赋值 
- Pod自动伸缩扩展
- Naming and dicovering
- 负载均衡
- 滚动更新
- 资源监控
- 日志访问
- 调用应用程序
- 认证和授权

k8s已经是容器领域中的事实标准。  

## 二 k8s基础架构

K8s的主要结构：
- Cluster：计算机资源的集合，k8s利用资源运行基于容器的应用
- Master：Cluster的大脑，负责管理、调度Node节点，即决定应用放在哪里运行，为了实现高可用，可以运行多个Master
- Node：负责运行容器应用、监控容器状态并汇报给Master
- Pod：k8s的最小工作单元，每个Pod包含一到多个容器，Pod中的容器会被作为一个整体被Master调度到一个Node上运行

## 三  minikube单机版k8s的安装

### 2.0 安装简介

k8s有三种搭建方式：
- minikube：单机版，https://minikube.sigs.k8s.io/docs/start/linux/)
- kubeadm：官方提供的集群版安装工具包
- 二进制方式：纯手动安装，https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG-1.16.md，下载 ServerBinaries安装

Minikube是由Kubernetes社区维护的单机版的Kubernetes集群，支持macOS, Linux, and Windows等多种操作系统平台，使用最新的官方stable版本，并支持Kubernetes的大部分功能，从基础的容器编排管理，到高级特性如负载均衡、Ingress，权限控制等。非常适合作为Kubernetes入门，或开发测试环境使用。Minikube实际是跑在本地的虚拟机中的，所以，需要先安装一套Hypervisor。这里以VirtualBox为例。  

### 2.1 Mac版安装步骤

需要代理

```
# 步骤一 mac需要安装任意一款虚拟机软件VirtualBox for Mac https://www.virtualbox.org/wiki/Downloads
# 若安装失败，打开安装包中的文件 VirtualBox_Uninstall.tool（打开即可），打开电脑的   系统偏好设置---->安全性与隐私---->通用，勾选oracle，重新安装即可

# 步骤二 mac安装docker：https://download.docker.com/mac/stable/Docker.dmg

# 步骤三 mac安装kubeCtl
brew install kubernetes-cli
kubectl version

# 步骤四 安装minikube
brew cask install minikube
 
# 步骤五 创建minikube集群
minikube start --registry-mirror=https://registry.docker-cn.com
 
# 如果执行失败，则可以执行
minikube delete
rm -rf ~/.minikue

# 启动成功后，可以查看一些集群信息
kubectl cluster-info
kubectl get nodes
minikube dashboard          # 自动打开管理界面
```

### 2.2 Linux安装步骤




