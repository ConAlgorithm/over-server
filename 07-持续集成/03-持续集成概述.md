## 一 软件开发模型

## 1.1 瀑布模型

瀑布模型是软件开发的常用模型，类似生产线的案例，按照结构流程在一个方向上流动。  

![](../images/cicd/cicd-01.png)  

瀑布模型简单易用，完成当前阶段后只需要关注后续阶段即可，项目也根据阶段的划分提供了检查点。  

瀑布模型也有着极大缺点：
- 由于是线性开发模型，只有开发末期才能见到开发结果，增加了项目风险
- 不能适应快速的用户需求变化，这也是瀑布模型最大缺点

### 1.2 敏捷开发

敏捷开发的核心是：
- 迭代式：传统开发采用一个大周期进行开发，如一年，迭代式开发将开发周期划分为多个小周期，即一次大开发变成多次小开发，每次小开发都是同样的流程，所以看上去就像重复在做同样的步骤
- 增量式：软件的每个版本，都会新增一个用户可以感知的可用版本，其实也是按照新增功能进行迭代式开发

敏捷开发虽然将软件开发划分成多个周期进行迭代，但是每个迭代周期都必须是完整的软件开发周期，必须按照软件工程的方法论，进行正规的流程管理。  

如图所示：  

![](../images/cicd/cicd-02.png)  

敏捷开发好处：
- 早期交付
- 降低风险

## 二 持续集成

持续集成和持续交付的概念：
- CI：持续集成（Continuous intergration）。新提交的代码在合并到主线之前，都需要通过编译和自动化测试流程进行验证。
- CD：持续交付（Continuous delivery）。指自动发布应用的功能。

持续集成的目的是为了让产品实现快速迭代，同时保持高质量。持续集成是敏捷开发的具体实现方案之一。  

持续集成的步骤：
- 提交：向代码仓库提交代码，后续所有步骤都开始于本次的提交
- 测试：代码仓库对commit操作配置钩子（hook），只要提交代码就会跑自动化测试
- 交付：测试没有问题，可以合并到主干，同时也会触发主干的测试钩子
- 构建：源码转换为可运行的实际代码，如配置各种资源、依赖等
- 二测：如果在上一次测试中没有涵盖全部测试，则构建的结果要进行第二轮测试。如果在第一伦测试中已经完成全部测试，则需要将构建移在第一轮测试前
- 部署：当前代码已经是可部署的版本，进行存档打包发送到生产服务器
- 回滚：如果当前版本在生产环境发生问题，则需要回滚，回滚最简单的做法就是修改符号链接，指向上一个版本的目录

持续集成的优点：
- 降低风险：不断的构建可以在早起发现问题，减少修复代价
- 减少重复性工作
- 持续部署，持续交付了可供使用的版本

注意：持续集成中交付的结果必须是个可用的产品！  

## 三 常见的持续集成工具

常见的持续集成工具：
- Jenkins：老牌持续集成工具，源自于Sun公司的Hudson。  
- GitlabCI：